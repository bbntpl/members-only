<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>TIC Clubhouse - Welcome to Members Page</title>
  <link rel='stylesheet' href='/stylesheets/style.css' />
  <link rel='stylesheet' href='/stylesheets/tailwind.css' />
  <link href='https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Montserrat:wght@600;700&display=swap' rel='stylesheet'>
</head>

<body class='bg-light text-dark font-sans min-h-screen'>
  <% include ./partials/verification-modal.ejs %>
	<% include ./partials/navbar.ejs %>
  <div class='flex'>
    <% include ./partials/members-side.ejs %>
    <main class='flex-grow p-4'>
      <% include ./partials/membership-section.ejs %>
      <% if(currentUser) { %>
      <div class='mb-4' id='create-post-btn'>
        <button class='bg-accent text-light py-2 px-4 rounded'>Create post</button>
      </div>
      <% } %>
      <div id='create-post-form' class='hidden py-2 my-3 bg-white shadow'>
        <form method='post' action='/public-posts/create'>
          <div class='mb-4 mx-4'>
            <label for='title' class='block text-gray-700 text-sm font-semibold mb-2'>Title:</label>
            <input type='text' id='title' name='title' placeholder='Enter post title' required class='w-full px-4 py-2 text-gray-700 bg-light border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent' />
          </div>
          <div class='mb-4 mx-4'>
            <label for='content' class='block text-gray-700 text-sm font-semibold mb-2'>Content:</label>
            <textarea id='content' name='content' placeholder='Enter post content' required class='w-full px-4 py-2 text-gray-700 bg-light border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent' rows='4'></textarea>
          </div>
          <button type='submit' class='w-auto mb-4 mx-4 py-2 px-4 text-white font-semibold bg-accent rounded-lg hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary'>
            Submit
          </button>
        </form>
      </div>
      <div class='max-h-72 overflow-auto'>
        <h2 class='font-headings text-secondary mb-4'>Posts</h2>
        <% if(posts.length > 0) { %>
        <div class='grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4'>
          <% posts.forEach(post => { %>
          <div class='bg-white rounded-lg shadow p-4'>
            <h2 class='text-xl font-semibold mb-2'>
              <%= post.title %>
            </h2>
            <p class='text-gray-700 mb-4'>
              <%= post.content.substring(0, 100) + (post.content.length > 100 ? '...' : '') %>
            </p>
            <p class='text-sm text-gray-500 mb-2'>
              Posted on <%= new Date(post.createdAt).toLocaleDateString() %> at <%= new Date(post.createdAt).toLocaleTimeString() %>
            </p>
            <% if (user && user.membershipStatus) { %>
            <p class='text-sm text-gray-700'>Posted by <%= post.author.username %></p>
            <% } else { %>
            <p class='text-sm text-gray-700'>Posted by Anonymous</p>
            <% } %>
          </div>
          <% }) %>
        </div>
        <% } else { %>
        <p>No posts yet. </p>
        <% } %>
      </div>
    </main>
  </div>
</body>
<script src='/javascripts/main.js'></script>
<script src='/javascripts/verify-code.js'></script>
<script src='/javascripts/send-code.js'></script>

</html>